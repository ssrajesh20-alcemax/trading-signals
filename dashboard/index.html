<!doctype html><html lang="en"><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><title>Trading Signals Dashboard</title><style>body{margin:0;font-family:system-ui,Segoe UI,Roboto,Arial;background:#0b1020;color:#e6edf3}header{position:sticky;top:0;background:#0b1020dd;border-bottom:1px solid #1f2942;padding:12px 16px}h1{font-size:18px;margin:0}.grid{display:grid;grid-template-columns:280px 1fr;gap:12px;margin:12px}@media(max-width:900px){.grid{grid-template-columns:1fr}}.card{background:#141a2e;border:1px solid #1f2942;border-radius:12px}.card h2{font-size:13px;margin:0;padding:10px 12px;border-bottom:1px solid #1f2942;color:#8aa0b5;text-transform:uppercase;letter-spacing:.08em}.panel{padding:12px}input,select,button{width:100%;padding:10px;border-radius:8px;border:1px solid #26314d;background:#0f1530;color:#e6edf3;margin:6px 0}button{cursor:pointer;background:linear-gradient(180deg,#2a72ff,#1e57d6);border:0}.inline{display:flex;gap:8px}.inline>*{flex:1}.chips{display:flex;flex-wrap:wrap;gap:8px}.chip{padding:6px 10px;border:1px solid #2a3b66;border-radius:20px;font-size:12px;color:#8aa0b5;background:#0f1530;cursor:pointer}.chip.active{color:#fff;border-color:#4da3ff;box-shadow:0 0 0 2px #4da3ff33 inset}.kpis{display:grid;grid-template-columns:repeat(3,1fr);gap:10px}.kpi{padding:10px;border-radius:10px;background:#0f1530;border:1px solid #233154}.kpi .v{font-weight:700}.signal{display:inline-flex;gap:8px;padding:6px 10px;border-radius:6px}.buy{background:#1b3e2b;border:1px solid #1f6a3c;color:#9ff0c2}.sell{background:#4a2121;border:1px solid #7a2a2a;color:#ffb1a8}.log{white-space:pre-wrap;max-height:160px;overflow:auto;background:#0a0f24;border-radius:8px;border:1px solid #1f2942;padding:10px;color:#8aa0b5}</style></head><body><header><h1>Trading Signals Dashboard</h1></header><div class="grid"><aside class="card"><h2>Controls</h2><div class="panel"><label>Symbol</label><input id="symbol" value="AAPL" placeholder="e.g., AAPL, TSLA, BTC-USD"/><div class="inline"><div><label>Market</label><select id="market"><option value="stocks" selected>US Stocks (Stooq)</option><option value="crypto">Crypto (CoinGecko)</option></select></div><div><label>Range</label><select id="range"><option value="90" selected>90d</option><option value="180">180d</option><option value="365">1y</option></select></div></div><label>Indicators</label><div id="indicators" class="chips"></div><div class="inline"><button id="run">Update</button><button id="reset" type="button">Reset</button></div><label>Latest Signal</label><div id="latestSignal"></div></div></aside><main class="card"><h2>Chart</h2><div class="panel"><canvas id="chart" height="260"></canvas><div class="kpis" style="margin-top:10px"><div class="kpi"><div class="v" id="kpiClose">-</div><div class="t">Last Close</div></div><div class="kpi"><div class="v" id="kpiTrend">-</div><div class="t">Trend (SMA/EMA)</div></div><div class="kpi"><div class="v" id="kpiVol">-</div><div class="t">Volatility (ATR)</div></div></div></div></main></div><section style="margin:12px"><div class="card"><h2>Signal Log</h2><div class="panel"><div id="log" class="log">Ready.</div></div></div></section><script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/technicalindicators@3.1.0/dist/browser.js"></script><script>const $=id=>document.getElementById(id);const log=m=>{const el=$("log");el.textContent+="\n"+m;el.scrollTop=el.scrollHeight};const IND=[{k:'sma',n:'SMA(20)',f:c=>ti.SMA.calculate({period:20,values:c})},{k:'ema',n:'EMA(20)',f:c=>ti.EMA.calculate({period:20,values:c})},{k:'rsi',n:'RSI(14)',f:c=>ti.RSI.calculate({period:14,values:c})},{k:'macd',n:'MACD hist',f:c=>ti.MACD.calculate({values:c,fastPeriod:12,slowPeriod:26,signalPeriod:9,SimpleMAOscillator:false,SimpleMASignal:false}).map(m=>m.MACD-m.signal)},{k:'atr',n:'ATR(14)',f:(_,h,l,c)=>ti.ATR.calculate({period:14,high:h,low:l,close:c})},];const selected=new Set(['sma','ema','rsi','atr']);const chips=$("indicators");IND.forEach(ind=>{const b=document.createElement('button');b.className='chip'+(selected.has(ind.k)?' active':'');b.textContent=ind.n;b.onclick=()=>{if(selected.has(ind.k))selected.delete(ind.k);else selected.add(ind.k);b.classList.toggle('active')};chips.appendChild(b)});async function fetchStocks(sym,days){const url=`https://stooq.com/q/d/l/?s=${sym.toLowerCase()}&i=d`;const r=await fetch(url);if(!r.ok)throw new Error('Stooq error');const t=await r.text();const rows=t.trim().split('\n').slice(-days-1);const out=[];for(let i=1;i<rows.length;i++){const [date,open,high,low,close,volume]=rows[i].split(',');out.push({date,open:+open,high:+high,low:+low,close:+close,volume:+volume})}return out}async function fetchCrypto(sym,days){const map={'btc-usd':'bitcoin','eth-usd':'ethereum','sol-usd':'solana'};const id=map[sym.toLowerCase()]||'bitcoin';const url=`https://api.coingecko.com/api/v3/coins/${id}/market_chart?vs_currency=usd&days=${days}`;const r=await fetch(url);if(!r.ok)throw new Error('CoinGecko error');const j=await r.json();return (j.prices||[]).map(p=>({date:new Date(p[0]).toISOString().slice(0,10),open:p[1],high:p[1],low:p[1],close:p[1],volume:0}))}function compute(ohlc){const c=ohlc.map(d=>d.close),h=ohlc.map(d=>d.high),l=ohlc.map(d=>d.low);const out={};IND.forEach(ind=>{if(!selected.has(ind.k))return;try{out[ind.k]=ind.f(c,h,l,c)}catch(e){console.warn('ind err',ind.k,e)}});const max=Math.max(0,...Object.values(out).map(a=>a?.length||0));const rows=ohlc.slice(-max).map((r,i)=>({date:r.date,close:r.close,sma:out.sma?.[out.sma.length-max+i],ema:out.ema?.[out.ema.length-max+i],rsi:out.rsi?.[out.rsi.length-max+i],macd:out.macd?.[out.macd.length-max+i],atr:out.atr?.[out.atr.length-max+i]}));const last=rows[rows.length-1]||{};let action='Neutral';if(last.ema&&last.sma&&last.rsi!=null&&last.macd!=null){const up=last.ema>last.sma;if(up&&last.rsi<70&&last.macd>0)action='Buy';if(!up&&last.rsi>30&&last.macd<0)action='Sell'}return {rows,last,action}}let chart;function draw(rows){const labels=rows.map(r=>r.date);const ds=[{label:'Close',data:rows.map(r=>r.close),borderColor:'#4da3ff',tension:.2}];if(selected.has('sma'))ds.push({label:'SMA',data:rows.map(r=>r.sma),borderColor:'#9ad0f5',borderDash:[4,4],tension:.2});if(selected.has('ema'))ds.push({label:'EMA',data:rows.map(r=>r.ema),borderColor:'#ffd166',tension:.2});if(selected.has('atr'))ds.push({label:'ATR',data:rows.map(r=>r.atr),borderColor:'#aaa',yAxisID:'y1'});chart&&chart.destroy();chart=new Chart($("chart"),{type:'line',data:{labels,datasets:ds},options:{responsive:true,interaction:{mode:'index',intersect:false},stacked:false,scales:{y:{grid:{color:'#1f2942'}},x:{grid:{color:'#1f294222'}},y1:{position:'right',grid:{drawOnChartArea:false}}},plugins:{legend:{labels:{color:'#c9d1d9'}}}}})}function kpis(last){$("kpiClose").textContent=last?.close?last.close.toFixed(2):'-';$("kpiTrend").textContent=last?.ema&&last?.sma?(last.ema>last.sma?'Up':'Down'):'-';$("kpiVol").textContent=last?.atr?last.atr.toFixed(2):'-'}function latest(action){const el=$("latestSignal");el.innerHTML='';const tag=document.createElement('span');tag.className='signal '+(action==='Buy'?'buy':action==='Sell'?'sell':'');tag.textContent=action;el.appendChild(tag)}async function run(){try{const sym=$("symbol").value.trim();const m=$("market").value;const days=+$("range").value;log(`Fetching ${sym} (${m}) for ${days} days...`);const ohlc= m==='crypto'? await fetchCrypto(sym,days): await fetchStocks(sym,days);const {rows,last,action}=compute(ohlc);draw(rows);kpis(last);latest(action);log(`Close ${last?.close?.toFixed?last.close.toFixed(2):'-'} | Trend ${last?.ema&&last?.sma?(last.ema>last.sma?'Up':'Down'):'-'} | Signal ${action}`)}catch(e){console.error(e);log('Error: '+(e?.message||e))}}$("run").onclick=run;$("reset").onclick=()=>{selected.clear();['sma','ema','rsi','atr'].forEach(k=>selected.add(k));chips.querySelectorAll('.chip').forEach(c=>c.classList.add('active'));run()};run();</script></body></html>
